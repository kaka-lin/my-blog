<!doctype html><html lang=en><head><title>[PyTorch] Tensors (張量) - Kaka's Blog
</title><meta charset=utf-8><meta http-equiv=X-UA-Compatible content="IE=edge,chrome=1"><meta name=viewport content="width=device-width,initial-scale=1,maximum-scale=1,minimum-scale=1,user-scalable=no,minimal-ui"><meta name=renderer content="webkit"><meta http-equiv=Cache-Control content="no-transform"><meta http-equiv=Cache-Control content="no-siteapp"><meta name=apple-mobile-web-app-capable content="yes"><meta name=apple-mobile-web-app-status-bar-style content="black"><meta name=format-detection content="telephone=no,email=no,adress=no"><meta name=theme-color content="#000000"><meta http-equiv=window-target content="_top"><meta name=description content="Tensors Tensors are a specialized data structure that are very similar to arrays and matrices. In PyTorch, we use tensors to encode the inputs and outputs of a model, as well as the model’s parameters. 張量 (Tensor) 類似向量或矩陣，他是一個 n-維 (n-dimensional) 的資料型態，像是: 0"><meta name=generator content="Hugo 0.126.3 with theme pure"><title>[PyTorch] Tensors (張量) - Kaka's Blog</title>
<link rel=stylesheet href=https://kaka-lin.github.io/my-blog/css/style.min.c42838cb837ce405361b2d6e3a1e99ddcc6be6d8be2766f2fe32a151d5664f19.css><link rel=stylesheet href=https://kaka-lin.github.io/my-blog/css/custom.css async><link rel=stylesheet href=//cdnjs.cloudflare.com/ajax/libs/highlight.js/10.1.2/styles/atom-one-dark.min.css><link rel=stylesheet href=https://cdnjs.cloudflare.com/ajax/libs/tocbot/4.4.2/tocbot.css async><meta property="og:url" content="https://kaka-lin.github.io/my-blog/2022/08/tensors/"><meta property="og:site_name" content="Kaka's Blog"><meta property="og:title" content="[PyTorch] Tensors (張量)"><meta property="og:description" content="Tensors Tensors are a specialized data structure that are very similar to arrays and matrices. In PyTorch, we use tensors to encode the inputs and outputs of a model, as well as the model’s parameters. 張量 (Tensor) 類似向量或矩陣，他是一個 n-維 (n-dimensional) 的資料型態，像是: 0"><meta property="og:locale" content="en"><meta property="og:type" content="article"><meta property="article:section" content="posts"><meta property="article:published_time" content="2022-08-17T00:00:00+00:00"><meta property="article:modified_time" content="2022-08-17T00:00:00+00:00"><meta property="og:see_also" content="https://kaka-lin.github.io/my-blog/2024/09/introduction/"><meta property="og:see_also" content="https://kaka-lin.github.io/my-blog/2024/06/segmentation/"><meta property="og:see_also" content="https://kaka-lin.github.io/my-blog/2022/09/resize_image/"><meta property="og:see_also" content="https://kaka-lin.github.io/my-blog/2022/09/progress_bar/"><meta property="og:see_also" content="https://kaka-lin.github.io/my-blog/2022/09/custom_training_loop/"><meta property="og:see_also" content="https://kaka-lin.github.io/my-blog/2022/08/introduction/"><meta property="og:see_also" content="https://kaka-lin.github.io/my-blog/2022/08/progress_bar/"><meta property="og:see_also" content="https://kaka-lin.github.io/my-blog/2024/09/introduction/"><meta property="og:see_also" content="https://kaka-lin.github.io/my-blog/2022/08/progress_bar/"><meta property="og:see_also" content="https://kaka-lin.github.io/my-blog/2022/08/datasets_dataloaders/"><meta itemprop=name content="[PyTorch] Tensors (張量)"><meta itemprop=description content="Tensors Tensors are a specialized data structure that are very similar to arrays and matrices. In PyTorch, we use tensors to encode the inputs and outputs of a model, as well as the model’s parameters. 張量 (Tensor) 類似向量或矩陣，他是一個 n-維 (n-dimensional) 的資料型態，像是: 0"><meta itemprop=datePublished content="2022-08-17T00:00:00+00:00"><meta itemprop=dateModified content="2022-08-17T00:00:00+00:00"><meta itemprop=wordCount content="1266"><meta itemprop=keywords content="ML/DL,Machine Learning,PyTorch"><meta name=twitter:card content="summary"><meta name=twitter:title content="[PyTorch] Tensors (張量)"><meta name=twitter:description content="Tensors Tensors are a specialized data structure that are very similar to arrays and matrices. In PyTorch, we use tensors to encode the inputs and outputs of a model, as well as the model’s parameters. 張量 (Tensor) 類似向量或矩陣，他是一個 n-維 (n-dimensional) 的資料型態，像是: 0"><!--[if lte IE 9]><script src=https://cdnjs.cloudflare.com/ajax/libs/classlist/1.1.20170427/classList.min.js></script><![endif]--><!--[if lt IE 9]><script src=https://cdn.jsdelivr.net/npm/html5shiv@3.7.3/dist/html5shiv.min.js></script><script src=https://cdn.jsdelivr.net/npm/respond.js@1.4.2/dest/respond.min.js></script><![endif]--></head><body class="main-center theme-black" itemscope itemtype=http://schema.org/WebPage><header class=header itemscope itemtype=http://schema.org/WPHeader><div class=slimContent><div class=navbar-header><div class="profile-block text-center"><a id=avatar href=https://github.com/kaka-lin target=_blank><img class="img-circle img-rotate" src=https://kaka-lin.github.io/my-blog/images/kaka_virtual.jpg width=200 height=200></a><h2 id=name class="hidden-xs hidden-sm">Kaka Lin</h2><h3 id=title class="hidden-xs hidden-sm hidden-md">Software Engineer</h3><small id=location class="text-muted hidden-xs hidden-sm"><i class="icon icon-map-marker"></i>Taipei, Taiwan</small></div><div class=search id=search-form-wrap><form class="search-form sidebar-form"><div class=input-group><input type=text class="search-form-input form-control" placeholder=Search>
<span class=input-group-btn><button type=submit class="search-form-submit btn btn-flat" onclick=return!1><i class="icon icon-search"></i></button></span></div><div class=ins-search><div class=ins-search-mask></div><div class=ins-search-container><div class=ins-input-wrapper><input type=text class=ins-search-input placeholder="Type something..." x-webkit-speech>
<button type=button class="close ins-close ins-selectable" data-dismiss=modal aria-label=Close><span aria-hidden=true>×</span></button></div><div class=ins-section-wrapper><div class=ins-section-container></div></div></div></div></form></div><button class="navbar-toggle collapsed" type=button data-toggle=collapse data-target=#main-navbar aria-controls=main-navbar aria-expanded=false>
<span class=sr-only>Toggle navigation</span>
<span class=icon-bar></span>
<span class=icon-bar></span>
<span class=icon-bar></span></button></div><nav id=main-navbar class="collapse navbar-collapse" itemscope itemtype=http://schema.org/SiteNavigationElement role=navigation><ul class="nav navbar-nav main-nav"><li class="menu-item menu-item-home"><a href=/my-blog/><i class="icon icon-home-fill"></i>
<span class=menu-title>Home</span></a></li><li class="menu-item menu-item-categories"><a href=/my-blog/categories/><i class="icon icon-folder"></i>
<span class=menu-title>Categories</span></a></li><li class="menu-item menu-item-books"><a href=/my-blog/series/><i class="icon icon-book-fill"></i>
<span class=menu-title>Study Notes</span></a></li><li class="menu-item menu-item-tags"><a href=/my-blog/tags/><i class="icon icon-tags"></i>
<span class=menu-title>Tags</span></a></li><li class="menu-item menu-item-about"><a href=/my-blog/about/><i class="icon icon-cup-fill"></i>
<span class=menu-title>About</span></a></li></ul></nav></div></header><aside class=sidebar itemscope itemtype=http://schema.org/WPSideBar><div class=slimContent><div class=widget><h3 class=widget-title>Categories</h3><div class=widget-body><ul class=category-list><li class=category-list-item><a href=https://kaka-lin.github.io/my-blog/categories/c++/ class=category-list-link>c++</a><span class=category-list-count>3</span></li><li class=category-list-item><a href=https://kaka-lin.github.io/my-blog/categories/canbus/ class=category-list-link>canbus</a><span class=category-list-count>2</span></li><li class=category-list-item><a href=https://kaka-lin.github.io/my-blog/categories/data-science/ class=category-list-link>data science</a><span class=category-list-count>4</span></li><li class=category-list-item><a href=https://kaka-lin.github.io/my-blog/categories/data-structure-and-algorithm/ class=category-list-link>data structure and algorithm</a><span class=category-list-count>16</span></li><li class=category-list-item><a href=https://kaka-lin.github.io/my-blog/categories/database/ class=category-list-link>database</a><span class=category-list-count>4</span></li><li class=category-list-item><a href=https://kaka-lin.github.io/my-blog/categories/devops/ class=category-list-link>devops</a><span class=category-list-count>2</span></li><li class=category-list-item><a href=https://kaka-lin.github.io/my-blog/categories/docker/ class=category-list-link>docker</a><span class=category-list-count>1</span></li><li class=category-list-item><a href=https://kaka-lin.github.io/my-blog/categories/go/ class=category-list-link>go</a><span class=category-list-count>8</span></li><li class=category-list-item><a href=https://kaka-lin.github.io/my-blog/categories/ml/dl/ class=category-list-link>ml/dl</a><span class=category-list-count>11</span></li><li class=category-list-item><a href=https://kaka-lin.github.io/my-blog/categories/os/ class=category-list-link>os</a><span class=category-list-count>3</span></li><li class=category-list-item><a href=https://kaka-lin.github.io/my-blog/categories/python/ class=category-list-link>python</a><span class=category-list-count>13</span></li><li class=category-list-item><a href=https://kaka-lin.github.io/my-blog/categories/qt/ class=category-list-link>qt</a><span class=category-list-count>1</span></li><li class=category-list-item><a href=https://kaka-lin.github.io/my-blog/categories/react/ class=category-list-link>react</a><span class=category-list-count>2</span></li></ul></div></div><div class=widget><h3 class=widget-title>Series</h3><div class=widget-body><ul class=series-list><li class=series-list-item><a href=https://kaka-lin.github.io/my-blog/series/asynchronous-programming/ class=series-list-link>asynchronous programming</a><span class=series-list-count>7</span></li><li class=series-list-item><a href=https://kaka-lin.github.io/my-blog/series/data-structure-and-algorithm/ class=series-list-link>data structure and algorithm</a><span class=series-list-count>16</span></li><li class=series-list-item><a href=https://kaka-lin.github.io/my-blog/series/distributed/ class=series-list-link>distributed</a><span class=series-list-count>1</span></li><li class=series-list-item><a href=https://kaka-lin.github.io/my-blog/series/go/ class=series-list-link>go</a><span class=series-list-count>7</span></li><li class=series-list-item><a href=https://kaka-lin.github.io/my-blog/series/machine-learning/ class=series-list-link>machine learning</a><span class=series-list-count>11</span></li><li class=series-list-item><a href=https://kaka-lin.github.io/my-blog/series/python/ class=series-list-link>python</a><span class=series-list-count>13</span></li><li class=series-list-item><a href=https://kaka-lin.github.io/my-blog/series/pytorch/ class=series-list-link>pytorch</a><span class=series-list-count>4</span></li><li class=series-list-item><a href=https://kaka-lin.github.io/my-blog/series/react/ class=series-list-link>react</a><span class=series-list-count>2</span></li><li class=series-list-item><a href=https://kaka-lin.github.io/my-blog/series/tensorflow/ class=series-list-link>tensorflow</a><span class=series-list-count>3</span></li><li class=series-list-item><a href=https://kaka-lin.github.io/my-blog/series/yolo-series/ class=series-list-link>yolo series</a><span class=series-list-count>1</span></li></ul></div></div><div class=widget><h3 class=widget-title>Tags</h3><div class=widget-body><ul class=tag-list><li class=tag-list-item><a href=https://kaka-lin.github.io/my-blog/tags/array/ class=tag-list-link>array</a><span class=tag-list-count>1</span></li><li class=tag-list-item><a href=https://kaka-lin.github.io/my-blog/tags/automatic-differentiation/ class=tag-list-link>automatic differentiation</a><span class=tag-list-count>3</span></li><li class=tag-list-item><a href=https://kaka-lin.github.io/my-blog/tags/canbus/ class=tag-list-link>canbus</a><span class=tag-list-count>2</span></li><li class=tag-list-item><a href=https://kaka-lin.github.io/my-blog/tags/ci/cd/ class=tag-list-link>ci/cd</a><span class=tag-list-count>1</span></li><li class=tag-list-item><a href=https://kaka-lin.github.io/my-blog/tags/classification/ class=tag-list-link>classification</a><span class=tag-list-count>1</span></li><li class=tag-list-item><a href=https://kaka-lin.github.io/my-blog/tags/concurrency/ class=tag-list-link>concurrency</a><span class=tag-list-count>2</span></li><li class=tag-list-item><a href=https://kaka-lin.github.io/my-blog/tags/coroutine/ class=tag-list-link>coroutine</a><span class=tag-list-count>2</span></li><li class=tag-list-item><a href=https://kaka-lin.github.io/my-blog/tags/distributed/ class=tag-list-link>distributed</a><span class=tag-list-count>1</span></li><li class=tag-list-item><a href=https://kaka-lin.github.io/my-blog/tags/docker/ class=tag-list-link>docker</a><span class=tag-list-count>1</span></li><li class=tag-list-item><a href=https://kaka-lin.github.io/my-blog/tags/dp/ class=tag-list-link>dp</a><span class=tag-list-count>2</span></li><li class=tag-list-item><a href=https://kaka-lin.github.io/my-blog/tags/generator/ class=tag-list-link>generator</a><span class=tag-list-count>1</span></li><li class=tag-list-item><a href=https://kaka-lin.github.io/my-blog/tags/google-trends/ class=tag-list-link>google trends</a><span class=tag-list-count>2</span></li><li class=tag-list-item><a href=https://kaka-lin.github.io/my-blog/tags/hash-table/ class=tag-list-link>hash table</a><span class=tag-list-count>1</span></li><li class=tag-list-item><a href=https://kaka-lin.github.io/my-blog/tags/heap/ class=tag-list-link>heap</a><span class=tag-list-count>2</span></li><li class=tag-list-item><a href=https://kaka-lin.github.io/my-blog/tags/i/o-models/ class=tag-list-link>i/o models</a><span class=tag-list-count>1</span></li><li class=tag-list-item><a href=https://kaka-lin.github.io/my-blog/tags/jupyter/ class=tag-list-link>jupyter</a><span class=tag-list-count>1</span></li><li class=tag-list-item><a href=https://kaka-lin.github.io/my-blog/tags/kvaser/ class=tag-list-link>kvaser</a><span class=tag-list-count>1</span></li><li class=tag-list-item><a href=https://kaka-lin.github.io/my-blog/tags/letterbox/ class=tag-list-link>letterbox</a><span class=tag-list-count>1</span></li><li class=tag-list-item><a href=https://kaka-lin.github.io/my-blog/tags/linked-list/ class=tag-list-link>linked list</a><span class=tag-list-count>1</span></li><li class=tag-list-item><a href=https://kaka-lin.github.io/my-blog/tags/matplotlib/ class=tag-list-link>matplotlib</a><span class=tag-list-count>1</span></li><li class=tag-list-item><a href=https://kaka-lin.github.io/my-blog/tags/metrics/ class=tag-list-link>metrics</a><span class=tag-list-count>3</span></li><li class=tag-list-item><a href=https://kaka-lin.github.io/my-blog/tags/mysql/ class=tag-list-link>mysql</a><span class=tag-list-count>1</span></li><li class=tag-list-item><a href=https://kaka-lin.github.io/my-blog/tags/object-detection/ class=tag-list-link>object detection</a><span class=tag-list-count>2</span></li><li class=tag-list-item><a href=https://kaka-lin.github.io/my-blog/tags/oop/ class=tag-list-link>oop</a><span class=tag-list-count>2</span></li><li class=tag-list-item><a href=https://kaka-lin.github.io/my-blog/tags/orm/ class=tag-list-link>orm</a><span class=tag-list-count>1</span></li><li class=tag-list-item><a href=https://kaka-lin.github.io/my-blog/tags/parallelism/ class=tag-list-link>parallelism</a><span class=tag-list-count>1</span></li><li class=tag-list-item><a href=https://kaka-lin.github.io/my-blog/tags/progressbar/ class=tag-list-link>progressbar</a><span class=tag-list-count>2</span></li><li class=tag-list-item><a href=https://kaka-lin.github.io/my-blog/tags/pytorch/ class=tag-list-link>pytorch</a><span class=tag-list-count>1</span></li><li class=tag-list-item><a href=https://kaka-lin.github.io/my-blog/tags/segmentation/ class=tag-list-link>segmentation</a><span class=tag-list-count>1</span></li><li class=tag-list-item><a href=https://kaka-lin.github.io/my-blog/tags/socketcan/ class=tag-list-link>socketcan</a><span class=tag-list-count>2</span></li><li class=tag-list-item><a href=https://kaka-lin.github.io/my-blog/tags/sqlalchemy/ class=tag-list-link>sqlalchemy</a><span class=tag-list-count>1</span></li><li class=tag-list-item><a href=https://kaka-lin.github.io/my-blog/tags/sqlite/ class=tag-list-link>sqlite</a><span class=tag-list-count>1</span></li><li class=tag-list-item><a href=https://kaka-lin.github.io/my-blog/tags/tree/ class=tag-list-link>tree</a><span class=tag-list-count>11</span></li></ul></div></div><div class=widget><h3 class=widget-title>Recent Posts</h3><div class=widget-body><ul class="recent-post-list list-unstyled no-thumbnail"><li><div class=item-inner><p class=item-title><a href=https://kaka-lin.github.io/my-blog/2024/09/introduction/ class=title>[Distributed] 分散式訓練介紹</a></p><p class=item-date><time datetime="2024-09-10 00:00:00 +0000 UTC" itemprop=datePublished>2024-09-10</time></p></div></li><li><div class=item-inner><p class=item-title><a href=https://kaka-lin.github.io/my-blog/2024/06/segmentation/ class=title>[Segmentation] 影像分割指標 (Segmentation Metrics)</a></p><p class=item-date><time datetime="2024-06-04 00:00:00 +0000 UTC" itemprop=datePublished>2024-06-04</time></p></div></li><li><div class=item-inner><p class=item-title><a href=https://kaka-lin.github.io/my-blog/2023/03/socketcan_example/ class=title>[CanBus] Example C code for SocketCAN</a></p><p class=item-date><time datetime="2023-03-27 00:00:00 +0000 UTC" itemprop=datePublished>2023-03-27</time></p></div></li><li><div class=item-inner><p class=item-title><a href=https://kaka-lin.github.io/my-blog/2023/03/kvaser_socketcan/ class=title>[CanBus] SocketCAN Support for Kvaser Devices</a></p><p class=item-date><time datetime="2023-03-23 00:00:00 +0000 UTC" itemprop=datePublished>2023-03-23</time></p></div></li><li><div class=item-inner><p class=item-title><a href=https://kaka-lin.github.io/my-blog/2022/09/red_black_tree_removal/ class=title>[DSA] 紅黑樹 (Red-Black Tree) 介紹 - Part 2: Removal</a></p><p class=item-date><time datetime="2022-09-28 00:00:00 +0000 UTC" itemprop=datePublished>2022-09-28</time></p></div></li></ul></div></div></div></aside><aside class="sidebar sidebar-toc collapse" id=collapseToc itemscope itemtype=http://schema.org/WPSideBar><div class=slimContent><h4 class=toc-title>Catalogue</h4><nav id=toc class="js-toc toc"></nav></div></aside><main class=main role=main><div class=content><article id=- class="article article-type-" itemscope itemtype=http://schema.org/BlogPosting><div class=article-header><h1 itemprop=name><a class=article-title href=/my-blog/2022/08/tensors/>[PyTorch] Tensors (張量)</a></h1><div class=article-meta><span class=article-date><i class="icon icon-calendar-check"></i>&nbsp;
<a href=https://kaka-lin.github.io/my-blog/2022/08/tensors/ class=article-date><time datetime="2022-08-17 00:00:00 +0000 UTC" itemprop=datePublished>2022-08-17</time>
</a></span><span class=article-category><i class="icon icon-folder"></i>&nbsp;
<a class=article-category-link href=/my-blog/categories/ml/dl/>ML/DL </a></span><span class=article-series><i class="icon icon-book"></i>&nbsp;
<a class=article-series-link href=/my-blog/series/machine-learning/>Machine Learning </a><a class=article-series-link href=/my-blog/series/pytorch/>PyTorch </a></span><span class=post-comment><i class="icon icon-comment"></i>&nbsp;<a href=/my-blog/2022/08/tensors/#comments class=article-comment-link>Comments</a></span></div></div><div class="article-entry marked-body js-toc-content" itemprop=articleBody><h1 id=tensors>Tensors</h1><blockquote><p>Tensors are a specialized data structure that are very similar to arrays and matrices. In PyTorch, we use tensors to encode the inputs and outputs of a model, as well as the model’s parameters.</p></blockquote><p><code>張量 (Tensor)</code> 類似向量或矩陣，他是一個 n-維 (n-dimensional) 的資料型態，像是:</p><ul><li>0 維: scalar</li><li>1 維: vector</li><li>2 維: matrix</li><li>n 維: n-dimensional array (ndarray)</li></ul><p>他是 Pytorch 最重要的資料結構，也是深度學習裡進行運算的基本元素。</p><blockquote><p>Tensors are similar to NumPy’s ndarrays, except that tensors can run on GPUs or other hardware accelerators. In fact, tensors and NumPy arrays can often share the same underlying memory, eliminating the need to copy data.</p></blockquote><p>Pytorch 的 tensor 在使用與操作上跟 Numpy 的 ndarray 有諸多的相似之處，但重要的是 <code>Pytorch 的 tensor 可以支援 CUDA 的 GPU 加速</code>，使我們可以使用 GPU 進行深度學習。</p><p>而且 Tensor 跟 Numpy arrays 可以輕鬆的轉換:</p><pre><code>因為他們之間共享相同的底層記憶體，從而無須複製 data
</code></pre><ul><li>詳見: <a href>Bridge with NumPy</a></li></ul><blockquote><p>Tensors are also optimized for automatic differentiation (we’ll see more about that later in the Autograd section). If you’re familiar with ndarrays, you’ll be right at home with the Tensor API. If not, follow along!</p></blockquote><h2 id=初始化張量-initializing-a-tensor>初始化張量 (Initializing a Tensor)</h2><p>Tensors can be initialized in various ways. Take a look at the following examples:</p><ol><li><h6 id=directly-from-data>Directly from data</h6><pre><code class=language-python>data = [[1, 2], [3, 4]]
x_data = torch.tensor(data)
</code></pre></li><li><h6 id=from-a-numpy-array>From a Numpy array</h6><pre><code class=language-python>np_array = np.array(data)
x_np = torch.from_numpy(np_array)
</code></pre></li><li><h6 id=from-another-tensor>From another tensor</h6><ul><li><p>保留張量屬性，如: shape, data type</p><pre><code class=language-python>x_ones = torch.ones_like(x_data) # retains the properties of x_data
print(f&quot;Ones Tensor: \n {x_ones} \n&quot;)
</code></pre><ul><li><a href=https://pytorch.org/docs/stable/generated/torch.ones_like.html>torch.ones_like</a>: 產生與給定張量相同形狀，但元素全為 1 的張量</li></ul></li><li><p>改變張量 datatype</p><pre><code class=language-python>x_rand = torch.rand_like(x_data, dtype=torch.float) # overrides the datatype of x_data
print(f&quot;Random Tensor: \n {x_rand} \n&quot;)
</code></pre><ul><li><a href=https://pytorch.org/docs/stable/generated/torch.rand_like.html>torch.rand_like</a>: 產生與給定張量相同形狀，但元素為 [0,1) 之間均勻分布的隨機數</li></ul></li></ul></li><li><h6 id=create-a-tensor>Create a Tensor</h6><p>Create a Tensor with empty, random, or constant values</p><pre><code class=language-python>shape = (2,3,)
empty_tensor = torch.empty(shape)
rand_tensor = torch.rand(shape)
ones_tensor = torch.ones(shape)
zeros_tensor = torch.zeros(shape)

print(f&quot;Empty Tensor: \n {empty_tensor} \n&quot;)
print(f&quot;Random Tensor: \n {rand_tensor} \n&quot;)
print(f&quot;Ones Tensor: \n {ones_tensor} \n&quot;)
print(f&quot;Zeros Tensor: \n {zeros_tensor}&quot;)
</code></pre><ul><li><a href=https://pytorch.org/docs/stable/generated/torch.empty.html>torch.empty</a>: 只是單純宣告記憶體區塊，並沒有初始化參數，因此裡面的參數可以是任何值</li></ul></li></ol><h2 id=張量屬性-attributes-of-a-tensor>張量屬性 (Attributes of a Tensor)</h2><ul><li><p>shape: Tensor 的大小</p></li><li><p>dtype: Tensor 裡面元素的資料型別</p></li><li><p>device: Tensor 所在的設備，CPU or GPU</p><pre><code class=language-python>tensor = torch.rand(3,4)

print(f&quot;Shape of tensor: {tensor.shape}&quot;)
print(f&quot;Datatype of tensor: {tensor.dtype}&quot;)
print(f&quot;Device tensor is stored on: {tensor.device}&quot;) # cpu
</code></pre></li></ul><h2 id=張量操作運算-operations-on-tensors>張量操作/運算 (Operations on Tensors)</h2><p>Over 100 tensor operations, including <code>arithmetic</code>, <code>linear algebra</code>, <code>matrix manipulation</code> (transposing, indexing, slicing), <code>sampling</code> and more are comprehensively described <a href=https://pytorch.org/docs/stable/torch.html>here</a>.</p><h5 id=standard-numpy-like-indexing-and-slicing>Standard numpy-like indexing and slicing:</h5><p>可以像 Numpy array 那樣取用部份資料，如下:</p><pre><code class=language-python>tensor = torch.ones(4, 4)
print(f&quot;First row: {tensor[0]}&quot;)
print(f&quot;First column: {tensor[:, 0]}&quot;)
print(f&quot;Last column: {tensor[..., -1]}&quot;)
tensor[:,1] = 0
print(tensor)
</code></pre><h5 id=arithmetic-operations-算術運算>Arithmetic operations (算術運算)</h5><ol><li><p>matrix multiplication</p><pre><code class=language-python>tensor = torch.tensor([[1, 1], [2, 2]])

# This computes the matrix multiplication between two tensors.
# y1, y2, y3 will have the same value
y1 = tensor @ tensor.T
y2 = tensor.matmul(tensor.T)

y3 = torch.rand_like(y1)
torch.matmul(tensor, tensor.T, out=y3)
</code></pre><p>output:</p><pre><code>tensor([[3, 3],
        [6, 6]])
</code></pre></li><li><p>element-wise product</p><pre><code class=language-python>tensor = torch.tensor([[1, 1], [2, 2]])

# This computes the element-wise product.
# z1, z2, z3 will have the same value
z1 = tensor * tensor
z2 = tensor.mul(tensor)

z3 = torch.rand_like(tensor)
torch.mul(tensor, tensor, out=z3)
</code></pre><p>output:</p><pre><code>tensor([[1, 1],
        [4, 4]])
</code></pre></li></ol><h5 id=single-element-tensors>Single-element tensors</h5><p>If you have a one-element tensor, for example by aggregating all values of a tensor into one value, you can convert it to a Python numerical value using <code>item()</code>:</p><pre><code class=language-python>tensor = torch.tensor([[1, 1], [2, 2]])
agg = tensor.sum()
agg_item = agg.item()
print(agg_item, type(agg_item))
</code></pre><p>output:</p><pre><code>6 &lt;class 'int'&gt;
</code></pre><h5 id=in-place-operations>In-place operations</h5><blockquote><p>Operations that store the result into the operand are called in-place.</p></blockquote><p>PyTorch 中大多數的操作都支持 <code>inplace</code> 操作，可以直接對 tensor 進行操作而不需要耗另外的記憶體。
方式非常簡單，在操作的符號後面加上 <code>_</code>，例如:</p><ul><li><code>x.copy_(y)</code>,</li><li><code>x.t_()</code></li></ul><pre><code class=language-python>print(f&quot;{tensor} \n&quot;)
tensor.add_(5)
print(tensor)
</code></pre><h2 id=bridge-with-numpy>Bridge with NumPy</h2><p>Tensors on the CPU and NumPy arrays can share their underlying memory locations, and changing one will change the other.</p><h3 id=tensor-to-numpy-array>Tensor to NumPy array</h3><pre><code class=language-python>t = torch.ones(5)
print(f&quot;t: {t}&quot;)
n = t.numpy()
print(f&quot;n: {n}&quot;)
</code></pre><p>output:</p><pre><code>t: tensor([1., 1., 1., 1., 1.])
n: [1. 1. 1. 1. 1.]
</code></pre><h5 id=changes-in-the-numpy-array-reflects-in-the-tensor>Changes in the NumPy array reflects in the tensor.</h5><p>如果是使用 CPU 來操作 Tensor，那麼 tensor 與 numpy array 會共享同一個記憶體，所以操作會被同步，如下:</p><pre><code class=language-python>t.add_(1)
print(f&quot;t: {t}&quot;)
print(f&quot;n: {n}&quot;)
</code></pre><p>output:</p><pre><code>t: tensor([2., 2., 2., 2., 2.])
n: [2. 2. 2. 2. 2.]
</code></pre><h3 id=numpy-array-to-tensor>NumPy array to Tensor</h3><pre><code class=language-python>n = np.ones(5)
t = torch.from_numpy(n)
</code></pre><h5 id=changes-in-the-numpy-array-reflects-in-the-tensor-1>Changes in the NumPy array reflects in the tensor.</h5><p>如果是使用 CPU 來操作 Tensor，那麼 tensor 與 numpy array 會共享同一個記憶體，所以操作會被同步，如下:</p><pre><code class=language-python>np.add(n, 1, out=n)
print(f&quot;t: {t}&quot;)
print(f&quot;n: {n}&quot;)
</code></pre><p>output:</p><pre><code>t: tensor([2., 2., 2., 2., 2.], dtype=torch.float64)
n: [2. 2. 2. 2. 2.]
</code></pre><h2 id=使用-gpu>使用 GPU</h2><p>Pytorch 中的各種張量運算皆可以在 GPU 上運行。</p><p>By default, tensors are created on the CPU. We can move tensors to the GPU using <a href=https://pytorch.org/docs/stable/generated/torch.Tensor.to.html#torch.Tensor.to>.to()</a> method.</p><blockquote><p>Keep in mind that copying large tensors across devices can be expensive in terms of time and memory!</p></blockquote><pre><code class=language-python># We move our tensor to the GPU if available
if torch.cuda.is_available():
    tensor = tensor.to(&quot;cuda&quot;)
</code></pre><ul><li><a href=https://pytorch.org/docs/stable/generated/torch.cuda.is_available.html>torch.cuda.is_available()</a>: 確認電腦上到底有沒有 GPU</li></ul><p>更多 CUDA 相關操作，請看<a href=https://pytorch.org/docs/stable/notes/cuda.html>這邊</a></p><h5 id=注意-numpy-只能在-cpu-上操作使用因此如果需要轉回-numpy-需要先把-tensor-送回-cpu-在操作>注意: NumPy 只能在 CPU 上操作使用，因此如果需要轉回 NumPy ，需要先把 Tensor 送回 CPU 在操作。</h5><h2 id=reference>Reference</h2><ul><li><a href=https://pytorch.org/tutorials/beginner/basics/tensorqs_tutorial.html#>PyTorch/Tutorials/Tensors</a></li><li><a href=https://weikaiwei.com/pytorch/tensor-storage-strides/>【PyTorch 內部機制】Tensor, Storage, Strides 張量如何存放在記憶體上？</a></li><li><a href=https://clay-atlas.com/blog/2019/08/02/pytorch-%E6%95%99%E5%AD%B8%EF%BC%88%E4%B8%80%EF%BC%89-%E5%BE%9E-tensor-%E8%A8%AD%E5%AE%9A%E9%96%8B%E5%A7%8B/>[PyTorch] Getting Start: 從 Tensor 設定開始</a></li><li><a href=https://wizardforcel.gitbooks.io/learn-dl-with-pytorch-liaoxingyu/content/2.1.html>Tensor and Variable</a></li></ul></div><div class=article-footer><blockquote class=mt-2x><ul class="post-copyright list-unstyled"><li class="post-copyright-link hidden-xs"><strong>Permalink: </strong><a href=https://kaka-lin.github.io/my-blog/2022/08/tensors/ title="[PyTorch] Tensors (張量)" target=_blank rel=external>https://kaka-lin.github.io/my-blog/2022/08/tensors/</a></li><li class=post-copyright-license><strong>License：</strong><a href=https://creativecommons.org/licenses/by/4.0/deed.zh_TW target=_blank rel=external>CC BY 4.0</a></li></ul></blockquote><div class="panel panel-default panel-badger"><div class=panel-body><figure class=media><div class=media-left><a href=https://github.com/kaka-lin target=_blank class="img-burn thumb-sm visible-lg"><img src=https://kaka-lin.github.io/my-blog/images/kaka_virtual.jpg class="img-rounded w-full" alt></a></div><div class=media-body><h3 class=media-heading><a href=https://github.com/kaka-lin target=_blank><span class=text-dark>Kaka Lin</span><small class=ml-1x>Software Engineer</small></a></h3><div>AIoT</div></div></figure></div></div></div></article><section id=comments><div id=disqus_thread><noscript>Please enable JavaScript to view the <a href=//disqus.com/?ref_noscript>comments powered by Disqus.</a></noscript></div></section></div><nav class="bar bar-footer clearfix" data-stick-bottom><div class=bar-inner><ul class="pager pull-left"><li class=prev><a href=https://kaka-lin.github.io/my-blog/2022/08/object_detection/ title="[Object Detection] 目標檢測評估指標 (Object Detection Metrics)"><i class="icon icon-angle-left" aria-hidden=true></i><span>&nbsp;&nbsp;Older</span></a></li><li class=next><a href=https://kaka-lin.github.io/my-blog/2022/08/datasets_dataloaders/ title="[PyTorch] Datasets & DataLoaders"><span>Newer&nbsp;&nbsp;</span><i class="icon icon-angle-right" aria-hidden=true></i></a></li><li class=toggle-toc><a class="toggle-btn collapsed" data-toggle=collapse href=#collapseToc aria-expanded=false title=Catalogue role=button><span>[&nbsp;</span><span>Catalogue</span>
<i class="text-collapsed icon icon-anchor"></i>
<i class="text-in icon icon-close"></i>
<span>]</span></a></li></ul><div class=bar-right></div></div></nav></main><footer class=footer itemscope itemtype=http://schema.org/WPFooter><ul class=social-links><li><a href="https://www.facebook.com/profile.php?id=100001656484042" target=_blank title=facebook data-toggle=tooltip data-placement=top><i class="icon icon-facebook"></i></a></li><li><a href=https://github.com/kaka-lin target=_blank title=github data-toggle=tooltip data-placement=top><i class="icon icon-github"></i></a></li><li><a href=https://www.linkedin.com/in/%E5%AE%B6%E8%B1%AA-%E6%9E%97-014a02116/ target=_blank title=linkedin data-toggle=tooltip data-placement=top><i class="icon icon-linkedin"></i></a></li></ul><div class=copyright>Copyright
&copy;2020 -
2024<div class=publishby>Theme by <a href=https://github.com/xiaoheiAh target=_blank>xiaoheiAh </a>base on<a href=https://github.com/xiaoheiAh/hugo-theme-pure target=_blank> pure</a>.</div></div></footer><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.2/MathJax.js?config=TeX-MML-AM_SVG"></script><script type=text/x-mathjax-config>
    MathJax.Hub.Config({
            showMathMenu: false, //disables context menu
            tex2jax: {
            inlineMath: [ ['$','$'], ['\\(','\\)'] ]
           }
    });
</script><script src=https://cdn.jsdelivr.net/npm/jquery@3.4.1/dist/jquery.min.js></script><script>window.jQuery||document.write('<script src="js/jquery.min.js"><\/script>')</script><script type=text/javascript src=//cdnjs.cloudflare.com/ajax/libs/highlight.js/10.1.2/highlight.min.js></script><script type=text/javascript src=//cdnjs.cloudflare.com/ajax/libs/highlight.js/10.1.2/languages/python.min.js defer></script><script type=text/javascript src=//cdnjs.cloudflare.com/ajax/libs/highlight.js/10.1.2/languages/javascript.min.js defer></script><script type=text/javascript src=//cdnjs.cloudflare.com/ajax/libs/highlight.js/10.1.2/languages/go.min.js defer></script><script type=text/javascript src=//cdnjs.cloudflare.com/ajax/libs/highlight.js/10.1.2/languages/c.min.js defer></script><script type=text/javascript src=//cdnjs.cloudflare.com/ajax/libs/highlight.js/10.1.2/languages/cpp.min.js defer></script><script>hljs.configure({tabReplace:"    ",classPrefix:""}),hljs.initHighlightingOnLoad()</script><script src=https://kaka-lin.github.io/my-blog/js/application.min.e4989ab4dc212027af8773861b05b6bc333a1217f6b0a1b3377a3a3dbd454483.js></script><script src=https://kaka-lin.github.io/my-blog/js/plugin.min.ee01f0915da127c8f127f6384fd08c677a9a87f16e6b265d282abf291b5065d9.js></script><script>(function(e){var t={TRANSLATION:{POSTS:"Posts",PAGES:"Pages",CATEGORIES:"Categories",TAGS:"Tags",UNTITLED:"(Untitled)"},ROOT_URL:"https://kaka-lin.github.io/my-blog/",CONTENT_URL:"https://kaka-lin.github.io/my-blog//searchindex.json "};e.INSIGHT_CONFIG=t})(window)</script><script type=text/javascript src=https://kaka-lin.github.io/my-blog/js/insight.min.716b0c6a00b68ccc31a2b65345f3412f4246ffa94a90f8e25d525528b4504f9937880692bbe619023233caba5d0a17ebe23d7cfb57cd3a88f23ea337ad5e4d00.js defer></script><script src=https://cdnjs.cloudflare.com/ajax/libs/tocbot/4.4.2/tocbot.min.js></script><script>tocbot.init({tocSelector:".js-toc",contentSelector:".js-toc-content",headingSelector:"h1, h2, h3",hasInnerContainers:!0})</script><script>var disqus_config=function(){this.page.url="https://kaka-lin.github.io/my-blog/2022/08/tensors/",this.page.identifier="kaka-blog"};(function(){var e=document,t=e.createElement("script");t.src="//kaka-blog.disqus.com/embed.js",t.setAttribute("data-timestamp",+new Date),(e.head||e.body).appendChild(t)})()</script></body></html>