<!doctype html><html lang=en><head><title>[DS] Google Trends 02: Convert to Google Data Studio - Kaka's Blog
</title><meta charset=utf-8><meta http-equiv=X-UA-Compatible content="IE=edge,chrome=1"><meta name=viewport content="width=device-width,initial-scale=1,maximum-scale=1,minimum-scale=1,user-scalable=no,minimal-ui"><meta name=renderer content="webkit"><meta http-equiv=Cache-Control content="no-transform"><meta http-equiv=Cache-Control content="no-siteapp"><meta name=apple-mobile-web-app-capable content="yes"><meta name=apple-mobile-web-app-status-bar-style content="black"><meta name=format-detection content="telephone=no,email=no,adress=no"><meta name=theme-color content="#000000"><meta http-equiv=window-target content="_top"><meta name=description content="Google Trends to Google Data Studio Get the result form Google Trends Using gspread transform the data of Google Trends to Google Sheets Import the file of Google Sheets into Google Data Studio Get the result from Goolge Trends import pandas as pd from pytrends.request import TrendReq # Create an instance(實例) of TrendReq pytrend = TrendReq() # Build a"><meta name=generator content="Hugo 0.126.3 with theme pure"><title>[DS] Google Trends 02: Convert to Google Data Studio - Kaka's Blog</title>
<link rel=stylesheet href=https://kaka-lin.github.io/my-blog/css/style.min.c42838cb837ce405361b2d6e3a1e99ddcc6be6d8be2766f2fe32a151d5664f19.css><link rel=stylesheet href=https://kaka-lin.github.io/my-blog/css/custom.css async><link rel=stylesheet href=//cdnjs.cloudflare.com/ajax/libs/highlight.js/10.1.2/styles/atom-one-dark.min.css><link rel=stylesheet href=https://cdnjs.cloudflare.com/ajax/libs/tocbot/4.4.2/tocbot.css async><meta property="og:url" content="https://kaka-lin.github.io/my-blog/2020/06/02_google_trends_to_google_data_studio/"><meta property="og:site_name" content="Kaka's Blog"><meta property="og:title" content="[DS] Google Trends 02: Convert to Google Data Studio"><meta property="og:description" content="Google Trends to Google Data Studio Get the result form Google Trends Using gspread transform the data of Google Trends to Google Sheets Import the file of Google Sheets into Google Data Studio Get the result from Goolge Trends import pandas as pd from pytrends.request import TrendReq # Create an instance(實例) of TrendReq pytrend = TrendReq() # Build a"><meta property="og:locale" content="en"><meta property="og:type" content="article"><meta property="article:section" content="posts"><meta property="article:published_time" content="2020-06-10T00:00:00+00:00"><meta property="article:modified_time" content="2020-06-10T00:00:00+00:00"><meta property="article:tag" content="Google Trends"><meta itemprop=name content="[DS] Google Trends 02: Convert to Google Data Studio"><meta itemprop=description content="Google Trends to Google Data Studio Get the result form Google Trends Using gspread transform the data of Google Trends to Google Sheets Import the file of Google Sheets into Google Data Studio Get the result from Goolge Trends import pandas as pd from pytrends.request import TrendReq # Create an instance(實例) of TrendReq pytrend = TrendReq() # Build a"><meta itemprop=datePublished content="2020-06-10T00:00:00+00:00"><meta itemprop=dateModified content="2020-06-10T00:00:00+00:00"><meta itemprop=wordCount content="938"><meta itemprop=keywords content="Google Trends"><meta name=twitter:card content="summary"><meta name=twitter:title content="[DS] Google Trends 02: Convert to Google Data Studio"><meta name=twitter:description content="Google Trends to Google Data Studio Get the result form Google Trends Using gspread transform the data of Google Trends to Google Sheets Import the file of Google Sheets into Google Data Studio Get the result from Goolge Trends import pandas as pd from pytrends.request import TrendReq # Create an instance(實例) of TrendReq pytrend = TrendReq() # Build a"><!--[if lte IE 9]><script src=https://cdnjs.cloudflare.com/ajax/libs/classlist/1.1.20170427/classList.min.js></script><![endif]--><!--[if lt IE 9]><script src=https://cdn.jsdelivr.net/npm/html5shiv@3.7.3/dist/html5shiv.min.js></script><script src=https://cdn.jsdelivr.net/npm/respond.js@1.4.2/dest/respond.min.js></script><![endif]--></head><body class="main-center theme-black" itemscope itemtype=http://schema.org/WebPage><header class=header itemscope itemtype=http://schema.org/WPHeader><div class=slimContent><div class=navbar-header><div class="profile-block text-center"><a id=avatar href=https://github.com/kaka-lin target=_blank><img class="img-circle img-rotate" src=https://kaka-lin.github.io/my-blog/images/kaka_virtual.jpg width=200 height=200></a><h2 id=name class="hidden-xs hidden-sm">Kaka Lin</h2><h3 id=title class="hidden-xs hidden-sm hidden-md">Software Engineer</h3><small id=location class="text-muted hidden-xs hidden-sm"><i class="icon icon-map-marker"></i>Taipei, Taiwan</small></div><div class=search id=search-form-wrap><form class="search-form sidebar-form"><div class=input-group><input type=text class="search-form-input form-control" placeholder=Search>
<span class=input-group-btn><button type=submit class="search-form-submit btn btn-flat" onclick=return!1><i class="icon icon-search"></i></button></span></div><div class=ins-search><div class=ins-search-mask></div><div class=ins-search-container><div class=ins-input-wrapper><input type=text class=ins-search-input placeholder="Type something..." x-webkit-speech>
<button type=button class="close ins-close ins-selectable" data-dismiss=modal aria-label=Close><span aria-hidden=true>×</span></button></div><div class=ins-section-wrapper><div class=ins-section-container></div></div></div></div></form></div><button class="navbar-toggle collapsed" type=button data-toggle=collapse data-target=#main-navbar aria-controls=main-navbar aria-expanded=false>
<span class=sr-only>Toggle navigation</span>
<span class=icon-bar></span>
<span class=icon-bar></span>
<span class=icon-bar></span></button></div><nav id=main-navbar class="collapse navbar-collapse" itemscope itemtype=http://schema.org/SiteNavigationElement role=navigation><ul class="nav navbar-nav main-nav"><li class="menu-item menu-item-home"><a href=/my-blog/><i class="icon icon-home-fill"></i>
<span class=menu-title>Home</span></a></li><li class="menu-item menu-item-categories"><a href=/my-blog/categories/><i class="icon icon-folder"></i>
<span class=menu-title>Categories</span></a></li><li class="menu-item menu-item-books"><a href=/my-blog/series/><i class="icon icon-book-fill"></i>
<span class=menu-title>Study Notes</span></a></li><li class="menu-item menu-item-tags"><a href=/my-blog/tags/><i class="icon icon-tags"></i>
<span class=menu-title>Tags</span></a></li><li class="menu-item menu-item-about"><a href=/my-blog/about/><i class="icon icon-cup-fill"></i>
<span class=menu-title>About</span></a></li></ul></nav></div></header><aside class=sidebar itemscope itemtype=http://schema.org/WPSideBar><div class=slimContent><div class=widget><h3 class=widget-title>Categories</h3><div class=widget-body><ul class=category-list><li class=category-list-item><a href=https://kaka-lin.github.io/my-blog/categories/c++/ class=category-list-link>c++</a><span class=category-list-count>3</span></li><li class=category-list-item><a href=https://kaka-lin.github.io/my-blog/categories/canbus/ class=category-list-link>canbus</a><span class=category-list-count>2</span></li><li class=category-list-item><a href=https://kaka-lin.github.io/my-blog/categories/data-science/ class=category-list-link>data science</a><span class=category-list-count>4</span></li><li class=category-list-item><a href=https://kaka-lin.github.io/my-blog/categories/data-structure-and-algorithm/ class=category-list-link>data structure and algorithm</a><span class=category-list-count>16</span></li><li class=category-list-item><a href=https://kaka-lin.github.io/my-blog/categories/database/ class=category-list-link>database</a><span class=category-list-count>4</span></li><li class=category-list-item><a href=https://kaka-lin.github.io/my-blog/categories/devops/ class=category-list-link>devops</a><span class=category-list-count>2</span></li><li class=category-list-item><a href=https://kaka-lin.github.io/my-blog/categories/docker/ class=category-list-link>docker</a><span class=category-list-count>1</span></li><li class=category-list-item><a href=https://kaka-lin.github.io/my-blog/categories/go/ class=category-list-link>go</a><span class=category-list-count>8</span></li><li class=category-list-item><a href=https://kaka-lin.github.io/my-blog/categories/ml/dl/ class=category-list-link>ml/dl</a><span class=category-list-count>9</span></li><li class=category-list-item><a href=https://kaka-lin.github.io/my-blog/categories/os/ class=category-list-link>os</a><span class=category-list-count>3</span></li><li class=category-list-item><a href=https://kaka-lin.github.io/my-blog/categories/python/ class=category-list-link>python</a><span class=category-list-count>13</span></li><li class=category-list-item><a href=https://kaka-lin.github.io/my-blog/categories/qt/ class=category-list-link>qt</a><span class=category-list-count>1</span></li><li class=category-list-item><a href=https://kaka-lin.github.io/my-blog/categories/react/ class=category-list-link>react</a><span class=category-list-count>2</span></li></ul></div></div><div class=widget><h3 class=widget-title>Series</h3><div class=widget-body><ul class=series-list><li class=series-list-item><a href=https://kaka-lin.github.io/my-blog/series/asynchronous-programming/ class=series-list-link>asynchronous programming</a><span class=series-list-count>7</span></li><li class=series-list-item><a href=https://kaka-lin.github.io/my-blog/series/data-structure-and-algorithm/ class=series-list-link>data structure and algorithm</a><span class=series-list-count>16</span></li><li class=series-list-item><a href=https://kaka-lin.github.io/my-blog/series/go/ class=series-list-link>go</a><span class=series-list-count>7</span></li><li class=series-list-item><a href=https://kaka-lin.github.io/my-blog/series/machine-learning/ class=series-list-link>machine learning</a><span class=series-list-count>9</span></li><li class=series-list-item><a href=https://kaka-lin.github.io/my-blog/series/python/ class=series-list-link>python</a><span class=series-list-count>13</span></li><li class=series-list-item><a href=https://kaka-lin.github.io/my-blog/series/pytorch/ class=series-list-link>pytorch</a><span class=series-list-count>3</span></li><li class=series-list-item><a href=https://kaka-lin.github.io/my-blog/series/react/ class=series-list-link>react</a><span class=series-list-count>2</span></li><li class=series-list-item><a href=https://kaka-lin.github.io/my-blog/series/tensorflow/ class=series-list-link>tensorflow</a><span class=series-list-count>3</span></li><li class=series-list-item><a href=https://kaka-lin.github.io/my-blog/series/yolo-series/ class=series-list-link>yolo series</a><span class=series-list-count>1</span></li></ul></div></div><div class=widget><h3 class=widget-title>Tags</h3><div class=widget-body><ul class=tag-list><li class=tag-list-item><a href=https://kaka-lin.github.io/my-blog/tags/array/ class=tag-list-link>array</a><span class=tag-list-count>1</span></li><li class=tag-list-item><a href=https://kaka-lin.github.io/my-blog/tags/automatic-differentiation/ class=tag-list-link>automatic differentiation</a><span class=tag-list-count>3</span></li><li class=tag-list-item><a href=https://kaka-lin.github.io/my-blog/tags/canbus/ class=tag-list-link>canbus</a><span class=tag-list-count>2</span></li><li class=tag-list-item><a href=https://kaka-lin.github.io/my-blog/tags/ci/cd/ class=tag-list-link>ci/cd</a><span class=tag-list-count>1</span></li><li class=tag-list-item><a href=https://kaka-lin.github.io/my-blog/tags/classification/ class=tag-list-link>classification</a><span class=tag-list-count>1</span></li><li class=tag-list-item><a href=https://kaka-lin.github.io/my-blog/tags/concurrency/ class=tag-list-link>concurrency</a><span class=tag-list-count>2</span></li><li class=tag-list-item><a href=https://kaka-lin.github.io/my-blog/tags/coroutine/ class=tag-list-link>coroutine</a><span class=tag-list-count>2</span></li><li class=tag-list-item><a href=https://kaka-lin.github.io/my-blog/tags/docker/ class=tag-list-link>docker</a><span class=tag-list-count>1</span></li><li class=tag-list-item><a href=https://kaka-lin.github.io/my-blog/tags/dp/ class=tag-list-link>dp</a><span class=tag-list-count>2</span></li><li class=tag-list-item><a href=https://kaka-lin.github.io/my-blog/tags/generator/ class=tag-list-link>generator</a><span class=tag-list-count>1</span></li><li class=tag-list-item><a href=https://kaka-lin.github.io/my-blog/tags/google-trends/ class=tag-list-link>google trends</a><span class=tag-list-count>2</span></li><li class=tag-list-item><a href=https://kaka-lin.github.io/my-blog/tags/hash-table/ class=tag-list-link>hash table</a><span class=tag-list-count>1</span></li><li class=tag-list-item><a href=https://kaka-lin.github.io/my-blog/tags/heap/ class=tag-list-link>heap</a><span class=tag-list-count>2</span></li><li class=tag-list-item><a href=https://kaka-lin.github.io/my-blog/tags/i/o-models/ class=tag-list-link>i/o models</a><span class=tag-list-count>1</span></li><li class=tag-list-item><a href=https://kaka-lin.github.io/my-blog/tags/jupyter/ class=tag-list-link>jupyter</a><span class=tag-list-count>1</span></li><li class=tag-list-item><a href=https://kaka-lin.github.io/my-blog/tags/kvaser/ class=tag-list-link>kvaser</a><span class=tag-list-count>1</span></li><li class=tag-list-item><a href=https://kaka-lin.github.io/my-blog/tags/letterbox/ class=tag-list-link>letterbox</a><span class=tag-list-count>1</span></li><li class=tag-list-item><a href=https://kaka-lin.github.io/my-blog/tags/linked-list/ class=tag-list-link>linked list</a><span class=tag-list-count>1</span></li><li class=tag-list-item><a href=https://kaka-lin.github.io/my-blog/tags/matplotlib/ class=tag-list-link>matplotlib</a><span class=tag-list-count>1</span></li><li class=tag-list-item><a href=https://kaka-lin.github.io/my-blog/tags/metrics/ class=tag-list-link>metrics</a><span class=tag-list-count>2</span></li><li class=tag-list-item><a href=https://kaka-lin.github.io/my-blog/tags/mysql/ class=tag-list-link>mysql</a><span class=tag-list-count>1</span></li><li class=tag-list-item><a href=https://kaka-lin.github.io/my-blog/tags/object-detection/ class=tag-list-link>object detection</a><span class=tag-list-count>2</span></li><li class=tag-list-item><a href=https://kaka-lin.github.io/my-blog/tags/oop/ class=tag-list-link>oop</a><span class=tag-list-count>2</span></li><li class=tag-list-item><a href=https://kaka-lin.github.io/my-blog/tags/orm/ class=tag-list-link>orm</a><span class=tag-list-count>1</span></li><li class=tag-list-item><a href=https://kaka-lin.github.io/my-blog/tags/parallelism/ class=tag-list-link>parallelism</a><span class=tag-list-count>1</span></li><li class=tag-list-item><a href=https://kaka-lin.github.io/my-blog/tags/progressbar/ class=tag-list-link>progressbar</a><span class=tag-list-count>2</span></li><li class=tag-list-item><a href=https://kaka-lin.github.io/my-blog/tags/socketcan/ class=tag-list-link>socketcan</a><span class=tag-list-count>2</span></li><li class=tag-list-item><a href=https://kaka-lin.github.io/my-blog/tags/sqlalchemy/ class=tag-list-link>sqlalchemy</a><span class=tag-list-count>1</span></li><li class=tag-list-item><a href=https://kaka-lin.github.io/my-blog/tags/sqlite/ class=tag-list-link>sqlite</a><span class=tag-list-count>1</span></li><li class=tag-list-item><a href=https://kaka-lin.github.io/my-blog/tags/tree/ class=tag-list-link>tree</a><span class=tag-list-count>11</span></li></ul></div></div><div class=widget><h3 class=widget-title>Recent Posts</h3><div class=widget-body><ul class="recent-post-list list-unstyled no-thumbnail"><li><div class=item-inner><p class=item-title><a href=https://kaka-lin.github.io/my-blog/2023/03/socketcan_example/ class=title>[CanBus] Example C code for SocketCAN</a></p><p class=item-date><time datetime="2023-03-27 00:00:00 +0000 UTC" itemprop=datePublished>2023-03-27</time></p></div></li><li><div class=item-inner><p class=item-title><a href=https://kaka-lin.github.io/my-blog/2023/03/kvaser_socketcan/ class=title>[CanBus] SocketCAN Support for Kvaser Devices</a></p><p class=item-date><time datetime="2023-03-23 00:00:00 +0000 UTC" itemprop=datePublished>2023-03-23</time></p></div></li><li><div class=item-inner><p class=item-title><a href=https://kaka-lin.github.io/my-blog/2022/09/red_black_tree_removal/ class=title>[DSA] 紅黑樹 (Red-Black Tree) 介紹 - Part 2: Removal</a></p><p class=item-date><time datetime="2022-09-28 00:00:00 +0000 UTC" itemprop=datePublished>2022-09-28</time></p></div></li><li><div class=item-inner><p class=item-title><a href=https://kaka-lin.github.io/my-blog/2022/09/red_black_tree/ class=title>[DSA] 紅黑樹 (Red-Black Tree) 介紹 - Part 1: Insertion</a></p><p class=item-date><time datetime="2022-09-24 00:00:00 +0000 UTC" itemprop=datePublished>2022-09-24</time></p></div></li><li><div class=item-inner><p class=item-title><a href=https://kaka-lin.github.io/my-blog/2022/09/2_3_4_tree/ class=title>[DSA] 2-3-4 Tree 介紹</a></p><p class=item-date><time datetime="2022-09-22 00:00:00 +0000 UTC" itemprop=datePublished>2022-09-22</time></p></div></li></ul></div></div></div></aside><aside class="sidebar sidebar-toc collapse" id=collapseToc itemscope itemtype=http://schema.org/WPSideBar><div class=slimContent><h4 class=toc-title>Catalogue</h4><nav id=toc class="js-toc toc"></nav></div></aside><main class=main role=main><div class=content><article id=- class="article article-type-" itemscope itemtype=http://schema.org/BlogPosting><div class=article-header><h1 itemprop=name><a class=article-title href=/my-blog/2020/06/02_google_trends_to_google_data_studio/>[DS] Google Trends 02: Convert to Google Data Studio</a></h1><div class=article-meta><span class=article-date><i class="icon icon-calendar-check"></i>&nbsp;
<a href=https://kaka-lin.github.io/my-blog/2020/06/02_google_trends_to_google_data_studio/ class=article-date><time datetime="2020-06-10 00:00:00 +0000 UTC" itemprop=datePublished>2020-06-10</time>
</a></span><span class=article-category><i class="icon icon-folder"></i>&nbsp;
<a class=article-category-link href=/my-blog/categories/data-science/>Data Science </a></span><span class=article-tag><i class="icon icon-tags"></i>&nbsp;
<a class=article-tag-link href=/my-blog/tags/google-trends/>Google Trends </a></span><span class=post-comment><i class="icon icon-comment"></i>&nbsp;<a href=/my-blog/2020/06/02_google_trends_to_google_data_studio/#comments class=article-comment-link>Comments</a></span></div></div><div class="article-entry marked-body js-toc-content" itemprop=articleBody><h1 id=google-trends-to-google-data-studio>Google Trends to Google Data Studio</h1><ol><li>Get the result form <code>Google Trends</code></li><li>Using <a href=https://github.com/burnash/gspread>gspread</a> transform the data of <code>Google Trends</code> to <code>Google Sheets</code></li><li>Import the file of <code>Google Sheets</code> into <code>Google Data Studio</code></li></ol><h2 id=get-the-result-from-goolge-trends>Get the result from <code>Goolge Trends</code></h2><pre><code class=language-python>import pandas as pd
from pytrends.request import TrendReq

# Create an instance(實例) of TrendReq
pytrend = TrendReq()

# Build a payload
pytrend.build_payload(kw_list=['Coronavirus'], timeframe='2020-01-01 2020-06-04')

# Requset data: Interest Over Time
covid_19_interest_over_time_df = pytrend.interest_over_time()
covid_19_interest_over_time_df.tail()
</code></pre><h2 id=plot-the-result>Plot the result</h2><pre><code class=language-python>import matplotlib
import matplotlib.pyplot as plt
import seaborn as sns

sns.set(color_codes=True)
plt.style.use('fivethirtyeight')

# 中文
plt.rcParams['font.sans-serif'] = ['Noto Sans Mono CJK TC', 'sans-serif']
plt.rcParams['axes.unicode_minus'] = False

%matplotlib inline
</code></pre><pre><code class=language-python>axes = covid_19_interest_over_time_df.plot.line(
    figsize=(20,5),
    title='The Search Trends of COVID-19 in 2020')
axes.set_yticks([0, 25, 50, 75, 100])
axes.set_xlabel('Date')
axes.set_ylabel('Trends Index')
axes.tick_params(axis='both', which='major', labelsize=13)
</code></pre><p><img src=images/google_trends_result_4.png alt>
<img src=/my-blog/images/data_science/google_trends/google_trends_result_4.png alt></p><h2 id=using-gspread-transform-the-data-of-google-trends-to-google-sheets>Using <code>gspread</code> transform the data of <code>Google Trends</code> to <code>Google Sheets</code></h2><p>Reference: <a href=https://gspread.readthedocs.io/en/latest/oauth2.html>Access spreadsheets via Google Sheets API.</a></p><h3 id=install-the-required-packages>Install the required packages</h3><ul><li><a href=https://github.com/burnash/gspread>gspread</a></li><li><a href=https://github.com/googleapis/oauth2client>oauth2client</a></li></ul><pre><code class=language-python>!pip3 install gspread oauth2client
</code></pre><h3 id=申請帳號並啟用api>申請帳號並啟用API</h3><p>因為我們要存取 <code>Google sheets</code>，
所以我們必須打開原本Google帳號的權限（或是申請一個新的帳號）</p><ol><li><p>到 <a href="https://console.developers.google.com/?hl=zh-tw">Google Cloud Platform</a> 建立一個<code>Project</code></p><p>新增專案 -> 專案名稱:<code>google-sheets</code> -> 建立</p><p><img src=images/google_apis_create_an_project_1.png alt>
<img src=/my-blog/images/data_science/google_trends/google_apis_create_an_project_1.png alt></p><p><img src=images/google_apis_create_an_project_2.png alt>
<img src=/my-blog/images/data_science/google_trends/google_apis_create_an_project_2.png alt></p></li><li><p>啟動該<code>Project</code>的 API</p><p>啟用API和服務 -> 在搜尋API和服務打上<code>Drive API</code> -> 啟用 -> 在搜尋API和服務打上<code>Sheets API(Google Sheets)</code> -> 啟用</p><p><img src=./images/google_apis_active_api_1.png alt>
<img src=/my-blog/images/data_science/google_trends/google_apis_active_api_1.png alt></p><p><img src=./images/google_apis_active_api_2.png alt>
<img src=/my-blog/images/data_science/google_trends/google_apis_active_api_2.png alt></p><p><img src=./images/google_apis_active_api_3.png alt>
<img src=/my-blog/images/data_science/google_trends/google_apis_active_api_3.png alt></p><p><img src=./images/google_apis_active_api_4.png alt>
<img src=/my-blog/images/data_science/google_trends/google_apis_active_api_4.png alt></p><p><img src=./images/google_apis_active_api_5.png alt>
<img src=/my-blog/images/data_science/google_trends/google_apis_active_api_5.png alt></p><p><img src=./images/google_apis_active_api_6.png alt>
<img src=/my-blog/images/data_science/google_trends/google_apis_active_api_6.png alt></p></li><li><p>建立憑證(Credentials)</p><p>回到首頁點選憑證 -> 建立憑證 -> 選服務帳號 -> 服務帳號詳細資料：<code>Google Trends to Google Sheets</code> -> 建立 -> 繼續 -> 建立金鑰 -> 選擇 <code>JSON</code> -> 建立 -> 完成</p><p><img src=./images/google_apis_create_credentials_1.png alt>
<img src=/my-blog/images/data_science/google_trends/google_apis_create_credentials_1.png alt></p><p><img src=./images/google_apis_create_credentials_2.png alt>
<img src=/my-blog/images/data_science/google_trends/google_apis_create_credentials_2.png alt></p><p><img src=./images/google_apis_create_credentials_3.png alt>
<img src=/my-blog/images/data_science/google_trends/google_apis_create_credentials_3.png alt></p><p><img src=./images/google_apis_create_credentials_4.png alt>
<img src=/my-blog/images/data_science/google_trends/google_apis_create_credentials_4.png alt></p><p><img src=./images/google_apis_create_credentials_5.png alt>
<img src=/my-blog/images/data_science/google_trends/google_apis_create_credentials_5.png alt></p><p><img src=./images/google_apis_create_credentials_6.png alt>
<img src=/my-blog/images/data_science/google_trends/google_apis_create_credentials_6.png alt></p></li><li><p>將下載好的<code>JSON</code>檔案取名為<code>auth.json</code></p></li></ol><h3 id=建立試算表>建立試算表</h3><p>透過<code>gspread</code>建立並使用試算表有兩種方式</p><ol><li><p>在<code>Google Drive</code>或是<a href=https://sheets.google.com>Google Sheets</a>建立試算表，並將開試算表分享給剛剛下載的<code>JSON</code>裡的<code>client_email</code>裡的帳號: <code>name...@...gserviceaccount.com</code>使用，並給予編輯的權限，這樣才有辦法透過程式存取。</p></li><li><p>透過<code>gspread</code>的<code>create()</code>創建試算表</p><pre><code class=language-python>sh = gc.create('A new spreadsheet')
</code></pre></li></ol><h5 id=note>Note:</h5><pre><code>If you’re using a service account,
this new spreadsheet will be visible only to your script's account.
To be able to access newly created spreadsheet
from Google Sheets with your own Google account you must share it with your email.
See how to share a spreadsheet in the section below.
</code></pre><ul><li><p>Sharing a Spreadsheet:</p><pre><code class=language-python>sh.share('your_email', perm_type='user', role='writer')
</code></pre></li></ul><p>以下使用第二種方法！</p><h4 id=connect-to-google-sheets>Connect to <code>Google Sheets</code></h4><pre><code class=language-python>import gspread
from google.oauth2.service_account import Credentials
</code></pre><pre><code class=language-python>def google_oauth2_service(auth_path, scopes):
    credentials = Credentials.from_service_account_file(
        auth_path,
        scopes=scopes
    )

    return gspread.authorize(credentials)
</code></pre><pre><code class=language-python>scopes = [
    'https://www.googleapis.com/auth/spreadsheets',
    'https://www.googleapis.com/auth/drive'
]

auth_path = 'google_sheets_auth.json'

gc = google_oauth2_service(auth_path, scopes)
</code></pre><h4 id=connetc-and-share-a-spreadsheet>Connetc and share a spreadsheet</h4><pre><code class=language-python># Create a spreadsheet
sh = gc.create(&quot;COVID-19 Search Trends&quot;)

# Share a spreadsheet
sh.share('vn503024@gmail.com', perm_type='user', role='writer')
</code></pre><h3 id=select-a-worksheet>Select a worksheet</h3><p>Select worksheet by index. Worksheet indexes start from zero:</p><pre><code class=language-python>worksheet = sh.get_worksheet(0)
</code></pre><p>Or by title:</p><pre><code class=language-python>worksheet = sh.worksheet(&quot;January&quot;)
</code></pre><p>Or the most common case: Sheet1:</p><pre><code class=language-python>worksheet = sh.sheet1
</code></pre><p>To get a list of all worksheets:</p><pre><code class=language-python>worksheet_list = sh.worksheets()
</code></pre><pre><code class=language-python>worksheet = gc.open(&quot;COVID-19 Search Trends&quot;).sheet1
</code></pre><h3 id=update-value-of-cell-send-dataframe-into-sheet>Update value of cell: send <code>DataFrame</code> into <code>sheet</code></h3><h4 id=prepocess-dataframe>Prepocess DataFrame</h4><ol><li><code>reset_index()</code>: 因為我們需要date這個欄位</li><li>conver datatime to string:<pre><code>Object of type 'Timestamp' is not JSON serializable
</code></pre></li></ol><pre><code class=language-python>covid_19_interest_over_time_df
</code></pre><pre><code class=language-python>covid_19_interest_over_time_df.index
</code></pre><pre><code>DatetimeIndex(['2020-01-01', '2020-01-02', '2020-01-03', '2020-01-04',
               '2020-01-05', '2020-01-06', '2020-01-07', '2020-01-08',
               '2020-01-09', '2020-01-10',
               ...
               '2020-05-24', '2020-05-25', '2020-05-26', '2020-05-27',
               '2020-05-28', '2020-05-29', '2020-05-30', '2020-05-31',
               '2020-06-01', '2020-06-02'],
              dtype='datetime64[ns]', name='date', length=154, freq=None)
</code></pre><ol><li>Reset index</li></ol><pre><code class=language-python>covid_19_interest_over_time_df.reset_index(inplace=True)
covid_19_interest_over_time_df
</code></pre><ol start=2><li>Convert datatime to string</li></ol><pre><code class=language-python>def convert_datetime_to_string(df):
    df['date'] = df['date'].dt.strftime('%Y-%m-%d %H:%M:%S')
</code></pre><pre><code class=language-python>convert_datetime_to_string(covid_19_interest_over_time_df)
covid_19_interest_over_time_df.head()
</code></pre><h4 id=send-datafram-into-sheet>Send <code>DataFram</code> into <code>Sheet</code></h4><pre><code class=language-python>def iter_pd(df):
    for val in df.columns:
        yield val

    for row in df.to_numpy():
        for val in row:
            if pd.isna(val):
                yield &quot;&quot;
            else:
                yield val

def pandas_to_sheets(pandas_df, sheet, clear=True):
    &quot;&quot;&quot;Update all values in a worksheet to match a pandas dataframe&quot;&quot;&quot;
    if clear:
        sheet.clear()

    (row, col) = pandas_df.shape
    cells = sheet.range(&quot;A1:{}&quot;.format(gspread.utils.rowcol_to_a1(row+1, col)))
    for cell, val in zip(cells, iter_pd(pandas_df)):
        cell.value = val

    sheet.update_cells(cells)
</code></pre><pre><code class=language-python>pandas_to_sheets(covid_19_interest_over_time_df, worksheet)
</code></pre><h4 id=result>Result</h4><ol><li><code>DataFrame</code></li></ol><p><img src=./images/dataframe_to_sheets_1.png alt>
<img src=/my-blog/images/data_science/google_trends/dataframe_to_sheets_1.png alt></p><ol start=2><li><code>Google Sheets</code></li></ol><p><img src=./images/dataframe_to_sheets_2.png alt>
<img src=/my-blog/images/data_science/google_trends/dataframe_to_sheets_2.png alt></p><ol start=3><li><code>DataFrame.plot.line()</code></li></ol><p><img src=./images/dataframe_to_sheets_3.png alt>
<img src=/my-blog/images/data_science/google_trends/dataframe_to_sheets_3.png alt></p><ol start=4><li><code>Google Data Studio</code>: 時間序列圖表</li></ol><p><img src=./images/dataframe_to_sheets_4.png alt>
<img src=/my-blog/images/data_science/google_trends/dataframe_to_sheets_4.png alt></p></div><div class=article-footer><blockquote class=mt-2x><ul class="post-copyright list-unstyled"><li class="post-copyright-link hidden-xs"><strong>Permalink: </strong><a href=https://kaka-lin.github.io/my-blog/2020/06/02_google_trends_to_google_data_studio/ title="[DS] Google Trends 02: Convert to Google Data Studio" target=_blank rel=external>https://kaka-lin.github.io/my-blog/2020/06/02_google_trends_to_google_data_studio/</a></li><li class=post-copyright-license><strong>License：</strong><a href=https://creativecommons.org/licenses/by/4.0/deed.zh_TW target=_blank rel=external>CC BY 4.0</a></li></ul></blockquote><div class="panel panel-default panel-badger"><div class=panel-body><figure class=media><div class=media-left><a href=https://github.com/kaka-lin target=_blank class="img-burn thumb-sm visible-lg"><img src=https://kaka-lin.github.io/my-blog/images/kaka_virtual.jpg class="img-rounded w-full" alt></a></div><div class=media-body><h3 class=media-heading><a href=https://github.com/kaka-lin target=_blank><span class=text-dark>Kaka Lin</span><small class=ml-1x>Software Engineer</small></a></h3><div>AIoT</div></div></figure></div></div></div></article><section id=comments><div id=disqus_thread><noscript>Please enable JavaScript to view the <a href=//disqus.com/?ref_noscript>comments powered by Disqus.</a></noscript></div></section></div><nav class="bar bar-footer clearfix" data-stick-bottom><div class=bar-inner><ul class="pager pull-left"><li class=prev><a href=https://kaka-lin.github.io/my-blog/2020/06/matplotlib_chinese/ title="[DS] Matplotlib show Chinese"><i class="icon icon-angle-left" aria-hidden=true></i><span>&nbsp;&nbsp;Older</span></a></li><li class=next><a href=https://kaka-lin.github.io/my-blog/2020/06/01_google_trends_and_python/ title="[DS] Google Trends 01: Operate with Python"><span>Newer&nbsp;&nbsp;</span><i class="icon icon-angle-right" aria-hidden=true></i></a></li><li class=toggle-toc><a class="toggle-btn collapsed" data-toggle=collapse href=#collapseToc aria-expanded=false title=Catalogue role=button><span>[&nbsp;</span><span>Catalogue</span>
<i class="text-collapsed icon icon-anchor"></i>
<i class="text-in icon icon-close"></i>
<span>]</span></a></li></ul><div class=bar-right></div></div></nav></main><footer class=footer itemscope itemtype=http://schema.org/WPFooter><ul class=social-links><li><a href="https://www.facebook.com/profile.php?id=100001656484042" target=_blank title=facebook data-toggle=tooltip data-placement=top><i class="icon icon-facebook"></i></a></li><li><a href=https://github.com/kaka-lin target=_blank title=github data-toggle=tooltip data-placement=top><i class="icon icon-github"></i></a></li><li><a href=https://www.linkedin.com/in/%E5%AE%B6%E8%B1%AA-%E6%9E%97-014a02116/ target=_blank title=linkedin data-toggle=tooltip data-placement=top><i class="icon icon-linkedin"></i></a></li></ul><div class=copyright>Copyright
&copy;2020 -
2024<div class=publishby>Theme by <a href=https://github.com/xiaoheiAh target=_blank>xiaoheiAh </a>base on<a href=https://github.com/xiaoheiAh/hugo-theme-pure target=_blank> pure</a>.</div></div></footer><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.2/MathJax.js?config=TeX-MML-AM_SVG"></script><script type=text/x-mathjax-config>
    MathJax.Hub.Config({
            showMathMenu: false, //disables context menu
            tex2jax: {
            inlineMath: [ ['$','$'], ['\\(','\\)'] ]
           }
    });
</script><script src=https://cdn.jsdelivr.net/npm/jquery@3.4.1/dist/jquery.min.js></script><script>window.jQuery||document.write('<script src="js/jquery.min.js"><\/script>')</script><script type=text/javascript src=//cdnjs.cloudflare.com/ajax/libs/highlight.js/10.1.2/highlight.min.js></script><script type=text/javascript src=//cdnjs.cloudflare.com/ajax/libs/highlight.js/10.1.2/languages/python.min.js defer></script><script type=text/javascript src=//cdnjs.cloudflare.com/ajax/libs/highlight.js/10.1.2/languages/javascript.min.js defer></script><script type=text/javascript src=//cdnjs.cloudflare.com/ajax/libs/highlight.js/10.1.2/languages/go.min.js defer></script><script type=text/javascript src=//cdnjs.cloudflare.com/ajax/libs/highlight.js/10.1.2/languages/c.min.js defer></script><script type=text/javascript src=//cdnjs.cloudflare.com/ajax/libs/highlight.js/10.1.2/languages/cpp.min.js defer></script><script>hljs.configure({tabReplace:"    ",classPrefix:""}),hljs.initHighlightingOnLoad()</script><script src=https://kaka-lin.github.io/my-blog/js/application.min.e4989ab4dc212027af8773861b05b6bc333a1217f6b0a1b3377a3a3dbd454483.js></script><script src=https://kaka-lin.github.io/my-blog/js/plugin.min.ee01f0915da127c8f127f6384fd08c677a9a87f16e6b265d282abf291b5065d9.js></script><script>(function(e){var t={TRANSLATION:{POSTS:"Posts",PAGES:"Pages",CATEGORIES:"Categories",TAGS:"Tags",UNTITLED:"(Untitled)"},ROOT_URL:"https://kaka-lin.github.io/my-blog/",CONTENT_URL:"https://kaka-lin.github.io/my-blog//searchindex.json "};e.INSIGHT_CONFIG=t})(window)</script><script type=text/javascript src=https://kaka-lin.github.io/my-blog/js/insight.min.716b0c6a00b68ccc31a2b65345f3412f4246ffa94a90f8e25d525528b4504f9937880692bbe619023233caba5d0a17ebe23d7cfb57cd3a88f23ea337ad5e4d00.js defer></script><script src=https://cdnjs.cloudflare.com/ajax/libs/tocbot/4.4.2/tocbot.min.js></script><script>tocbot.init({tocSelector:".js-toc",contentSelector:".js-toc-content",headingSelector:"h1, h2, h3",hasInnerContainers:!0})</script><script>var disqus_config=function(){this.page.url="https://kaka-lin.github.io/my-blog/2020/06/02_google_trends_to_google_data_studio/",this.page.identifier="kaka-blog"};(function(){var e=document,t=e.createElement("script");t.src="//kaka-blog.disqus.com/embed.js",t.setAttribute("data-timestamp",+new Date),(e.head||e.body).appendChild(t)})()</script></body></html>